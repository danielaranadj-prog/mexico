---
interface Props {
    title: string;
    description?: string;
    image?: string;
}

const { title, description = "Guía de viaje personalizada para México 2026 - Itinerarios, tours y consejos prácticos", image = "/mexico/og-image.jpg" } = Astro.props;
const canonicalURL = new URL(Astro.url.pathname, 'https://www.instantetrips.com');

import '../styles/global.css';
---

<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content={description} />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
        <title>{title}</title>
        
        <!-- SEO -->
        <link rel="canonical" href={canonicalURL.href} />
        <meta name="robots" content="index, follow" />
        <meta name="author" content="Instante Trips" />
        
        <!-- Open Graph / Social -->
        <meta property="og:type" content="website" />
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:image" content={`https://www.instantetrips.com${image}`} />
        <meta property="og:url" content={canonicalURL.href} />
        <meta property="og:site_name" content="Instante Trips - México" />
        
        <!-- Twitter Card -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={title} />
        <meta name="twitter:description" content={description} />
        <meta name="twitter:image" content={`https://www.instantetrips.com${image}`} />

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="México 26" />
        
        <link rel="manifest" href="/mexico/manifest.json" />
        <link rel="apple-touch-icon" href="/mexico/logo-ios.png" />
        <link rel="icon" type="image/svg+xml" href="/mexico/logo.svg" />

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600;800&family=Inter:wght@300;400&family=IBM+Plex+Serif:wght@400;500;600&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    </head>
    <script>
        // GUARDIAN SCRIPT - MAINTENANCE MODE
        (async function() {
            try {
                const COUNTRY = 'mexico'; // Change for each repo
                const URL = 'https://firestore.googleapis.com/v1/projects/instantetrips-editor/databases/(default)/documents/settings/general';
                
                const response = await fetch(URL);
                const data = await response.json();
                
                // Parse Firestore REST structure
                const maintenanceMode = data.fields?.maintenance_mode?.mapValue?.fields?.[COUNTRY]?.booleanValue;
                
                if (maintenanceMode === true) {
                    // STOP EVERYTHING AND SHOW OVERLAY
                    document.documentElement.innerHTML = `
                        <!DOCTYPE html>
                        <html lang="es">
                        <head>
                            <meta charset="UTF-8">
                            <title>Sitio en Mantenimiento | Instante Trips</title>
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
                            <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&family=IBM+Plex+Serif:wght@400&display=swap" rel="stylesheet">
                            <style>
                                body { margin: 0; padding: 0; background: #0f172a; color: white; display: flex; align-items: center; justify-content: center; height: 100vh; font-family: 'IBM Plex Serif', serif; overflow: hidden; }
                                .container { text-align: center; max-width: 600px; padding: 20px; animation: fadeIn 1s ease-out; }
                                h1 { font-family: 'Montserrat', sans-serif; font-size: 3rem; margin-bottom: 20px; color: #10b981; text-transform: uppercase; letter-spacing: -2px; }
                                p { font-size: 1.2rem; line-height: 1.6; color: #94a3b8; margin-bottom: 40px; }
                                .loader { width: 50px; height: 50px; border: 3px solid rgba(16, 185, 129, 0.3); border-radius: 50%; border-top-color: #10b981; animation: spin 1s ease-in-out infinite; margin: 0 auto; }
                                @keyframes spin { to { transform: rotate(360deg); } }
                                @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
                            </style>
                        </head>
                        <body>
                            <div class="container">
                                <div class="loader" style="margin-bottom: 30px;"></div>
                                <h1>En Construcción</h1>
                                <p>Estamos preparando las mejores experiencias de México para ti.<br>Volveremos muy pronto.</p>
                                <p style="font-size: 0.9rem; opacity: 0.5;">&copy; 2026 Instante Trips</p>
                            </div>
                        </body>
                        </html>
                    `;
                    // Stop further execution
                    throw new Error("Maintenance Mode Active");
                }
            } catch (e) {
                if (e.message !== "Maintenance Mode Active") console.log('Guardian Check Passed');
            }
        })();
    </script>
    <body>
        <slot />

        <footer class="minimal-footer">
            <div class="footer-content">
                <a href="/mexico/legal" class="legal-link">Legales y Privacidad</a>
            </div>
            
            <div class="dev-line">
                Desarrollado por <a href=https://www.instantetrips.com target="_blank">Instante Trips</a>
            </div>
        </footer>
    </body>
</html>

<style is:global>
    /* --- VARIABLES DE DISEÑO PREMIUM --- */
    /* --- KEYFRAMES PREMIUM --- */
    @keyframes shimmer {
        0%, 100% { background-position: -200% center; }
        50% { background-position: 200% center; }
    }

    @keyframes fadeInUp {
        from { 
            opacity: 0; 
            transform: translateY(20px); 
        }
        to { 
            opacity: 1; 
            transform: translateY(0); 
        }
    }

    @keyframes borderGlow {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 0 20px rgba(244, 185, 66, 0.3); }
        50% { box-shadow: 0 0 30px rgba(244, 185, 66, 0.5); }
    }

    /* --- ESTILOS BASE --- */
    html {
        scroll-behavior: smooth;
        -webkit-text-size-adjust: 100%;
    }

    body {
        font-family: 'IBM Plex Serif', Georgia, serif;
        background-color: var(--bg);
        color: var(--text);
        margin: 0;
        padding: 0;
        font-size: 16px;
        letter-spacing: -0.01em;
        line-height: 1.7;
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
        transition: background-color 0.3s, color 0.3s;
        overflow-x: hidden;
    }

    h1, h2, h3, h4, h5, h6 {
        font-family: 'Montserrat', sans-serif;
        font-weight: 800;
        color: var(--title);
        letter-spacing: -0.03em;
        text-transform: none;
        line-height: 1.2;
    }

    /* Utility class for shimmer text */
    .shimmer-text {
        background: linear-gradient(
            90deg, 
            var(--title) 0%, 
            var(--gold) 25%, 
            var(--title) 50%,
            var(--celeste) 75%,
            var(--title) 100%
        );
        background-size: 400% auto;
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: shimmer 4s ease-in-out infinite;
    }

    /* Fade in animation class */
    .fade-in-up {
        animation: fadeInUp 0.6s ease-out forwards;
    }

    .adaptive-logo, .menu-btn {
        transition: filter 0.3s ease;
    }

    @media (prefers-color-scheme: light) {
        .adaptive-logo, .menu-btn {
            filter: brightness(0);
        }
    }

    @media (prefers-color-scheme: dark) {
        .adaptive-logo, .menu-btn {
            filter: brightness(0) invert(1);
        }
    }

    a {
        color: inherit;
        text-decoration: none;
    }
/* ========================================= */
    /* ESTILOS DEL FOOTER ULTRA MINIMALISTA     */
    /* ========================================= */
    .minimal-footer {
        padding: 20px 0; /* Mucho menos espacio vertical */
        margin-top: 40px;
        border-top: 1px solid var(--border);
        text-align: center;
        background-color: var(--bg);
    }

    .footer-content {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: px;
        font-size: 0.9rem; /* Letra chica */
        color: var(--text-secondary);
        margin-bottom: 5px;
    }

    .separator {
        color: var(--border); /* Muy sutil */
    }

    .legal-link {
        color: var(--text-secondary);
        text-decoration: none;
        transition: color 0.2s;
    }

    .legal-link:hover {
        color: var(--gold);
        text-decoration: underline;
    }

    .dev-line {
        font-size: rem; /* Aún más chico para los créditos */
        color: var(--text-secondary);
        opacity: 0.6;
    }

    .dev-line a {
        font-weight: 600;
        color: var(--text);
    }

    /* En móviles muy estrechos, apilar los elementos del copyright */
    @media (max-width: 400px) {
        .footer-content {
            flex-direction: column;
            gap: 2px;
        }
        .separator {
            display: none;
        }
    }
</style>